import socket
import re

HOST = 'localhost'
PORT = 9999
# Creamos un socket del cliente
client_socket = socket.socket()
client_socket.connect((HOST, PORT))

# Función para ingresar correo electrónico y contraseña
def ingresar_credenciales():
    email = input("Ingrese su correo electrónico: ")
    while not re.match(r"[^@]+@[^@]+\.[^@]+", email):
        print("El correo electrónico no es válido.")
        email = input("Ingrese su correo electrónico: ")
    contrasena = input("Ingrese su contraseña: ")
    return f"{email},{contrasena}"

# Proceso de inicio de sesión o registro
ingresado_con_exito = False
while not ingresado_con_exito:
    # Mostrar menú
    print("1. Iniciar sesión")
    print("2. Registrarse")
    opcion = input("Seleccione una opción: ")

    # Ingresar credenciales
    credenciales = ingresar_credenciales()

    # Enviar opción y credenciales al servidor
    client_socket.send(f"{opcion},{credenciales}".encode())

    # Recibir respuesta del servidor
    respuesta = client_socket.recv(1024).decode()

    if respuesta == "OK":
        print("Operación exitosa.")
        ingresado_con_exito = True
    else:
        print(respuesta)

# Pedir apodo al usuario
nickname = input("Ingrese su apodo: ")
client_socket.send(nickname.encode())

# Cerrar conexión
client_socket.close()
